title: 关于wow游戏插件制作之前的几件事
date: 2016-08-08 15:29:00
categories: wower
tags: [wow, lua, addons]
-----------


如果你是一个游戏迷，或者说魔兽世界迷，那么你一定不会对插件这个东西感觉到陌生；如果你是一个用代码写人生的家伙，那么你一定要接触一下Lua这门语言；如果你只是对魔兽插件表示好奇，那么请保持这种好奇的态度。我们今天要说的，就是魔兽世界游戏插件的事情。
<!-- more -->

那么在做插件之前，你得要了解几件事情。

## 下载游戏

魔兽世界从2004年在中国登录已经有十多年的历史，迭代过N个版本，客户端也由最初的不到10个G发展到现在的40多个G。然而下载游戏时，你除了要考虑到你硬盘是否够用，下载的问题可以交给战网客户端，暴雪自己的线路绝对可以保证你在一个晚上就下载下来整个客户端。这里我要提醒下各位，你最好将你的游戏下载到一个移动硬盘里，毕竟客户端体积较大，下载到硬盘里那么你就可以带着硬盘随时调试或者玩魔兽啦，而且USB3.0完全可以满足你硬盘的读写速度。

那么我们要提到的就是战网客户端了。战网是暴雪为方便玩家对其游戏的管理制作的一个游戏管理客户端，在战网上你可以获取到所有暴雪官方游戏客户端。在战网下载页面，我们可以下载到各种语言的战网。同时要提一下，国服的战网是一个封闭的环境，如果我们下载国服的客户端，只能够登录国服的帐号，也就是在中国大陆申请的帐号，不包括台湾香港的帐号。而美国战网的客户端则是一个开放的环境，可以登录任何地区的帐号。

我们在进行插件调试的过程中，会遇到插件本地化的问题，也就是如果你用中文进行插件制作，中途会遇到时不知明的问题，所以，我们强烈建议下载美服的客户端，下载纯正的美国魔兽世界客户端，之后再进行汉化，这样一来，我们省去了插件制作中中文编码导致插件错误的问题。后期我们会单独进行插件的汉化。

接下来就是下载美国战网客户端，[下载地址](http://us.battle.net/en/)，你可能会需要用到vpn翻墙下载，可能。下载下来我们安装到电脑上。这个过程可能遇到的问题是，如果你第一次没有安装成功，那么你在接下来的安装过程中可能会遇到进度条卡在中间一直不动的情况，而且等了很久之后仍然是一动也不动。这个时候我们就不要再等它出现奇迹了，你要做的是关掉它，找到你的用户目录，找到你用户目录下关于*Battle.net*以及*Blizzard*的缓存，这些目录有可能是隐藏掉的，上网找一下如何让它们显现出来的方法，如果你找不到这些目录，那你仍然可以上网找一下，这里就不再贴目录了，windows和mac下的目录不一样，但是大致都差不多；找到这些文件，不要犹豫全部删掉它，一点不剩。然后重装你的战网。

接下来安装完战网客户端之后就要安装游戏了，不过我们先不要安装游戏，首先去注册一个美服的战网让我们可以登录美服，注册的时候我们选台湾地区，因为是实名的，会让我们输入身份证号。

帐号有了之后，我们并不马上打开客户端，打开你的战网客户端配置文件目录，过程如下：

windows下，打开C盘(系统盘)，用户，你的机器名字，找到AppData；AppData这个文件默认是隐藏的，所以你需要在文件夹选项里点击查看，勾选显示 隐藏文件、文件夹，这样就可以看到AppData了！点击Roaming，找到Battle.net，如果很多可以按快捷键B，在用记事本打开Battle.net；

在mac下，打开finder，command+shift+g打开，复制`~/Library/Application Support/Battle.net`，粘贴到输入框，用文本软件打开*Battle.net.config*文件；

接下来修改修改Client语法下的AllowedRegions区域，将AllowedRegions区域加入CN;US;EU;KR ，Regions就是你的登录可以选择的区域，CN就是国服;US美服;EU欧服;KR韩/台服。(根据自己的喜好选择对应的区域)

Locales是你的登录器语言，加入zhCN就是简体中文版登录器;

```
"Client":

{

　　"AllowedRegions": "CN;US;EU;KR",
　　"AllowedLocales": 
　　"zhCN;deDE;enGB;enUS;esMX;esES;frFR;itIT;plPL;ptBR;ruRU;koKR;zhTW"

}

```

客户端测试及语言设置,Config.wtf文件修改为：(此项也可以不用修改)

```
SET portal "US-test"

SET textLocale "zhCN"

SET audioLocale "enUS"

SET installLocale "enUS"
```

修改完成后进入客户端，选择北美地区，登入战网，之后点安装，战网就会下载美服客户端。下载完成后如果要登入国服帐号，选择中国地区，客户端会自动下载汉化更新，这样你的战网就可以既登录美服，也可登录国服了。

## 游戏语言

毫无疑问，接下来要说的就是插件的语言了。魔兽世界使用Lua配合xml对插件进行开发，游戏逻辑使用Lua，界面使用xml。做过Cocos2dx的朋友应该使用过Lua进行过快速开发，做为一个小巧的脚本语言，它在游戏开发中还是很有市场的。接下来我们要做的就是在电脑上安装Lua；

lua官方网站上有详细的安装过程，英文好的同学可以自行看原文进行操作。[lua.org](https://www.lua.org/)

下载lua，[download](https://www.lua.org/ftp/)，页面显示了lua的各个版本，建议下载最新版本。下载后解压缩会生成一个目录。

用终端进入到目录里，具体操作就是在终端里输入cd,中间加个空格，然后把你目录的路径复制到那里（把文件往终端里一拉就有了）。你不知道widows的终端怎么进？win+R，输入cmd，就出来了。

接下来，终端输入`make xxx install`，这里的xxx，在下面选：

```
aix bsd c89 freebsd generic linux macosx mingw posix solaris
```


windows下建议下载一个Lua for windows的软件，不认为windows下用终端要方便好多。

安装完成后在终端直接敲lua，看看安装是否成功。

安装完成后我们就可以在终端进行lua的学习了，语法学习是一个枯燥的过程，建议找本书照着例子多敲，这里我们推荐书《Programming in Lua》，网上有中文的翻译，想快速上手写的话可以看这篇帖子，先大致了解下lua的语法，[Lua学习](http://bbs.ngacn.cc/read.php?tid=6621402)。

## 插件库

我们魔兽的所有插件都会以文件夹的形式保存在*World of Warcraft/Interface/AddOns*下，我们以后做的插件放在这里才会被系统识别。不过本篇我们不说插件制作的事情，这里只是告诉读者，这里是我们进入魔兽插件开发的入口。

我们要用到的插件库叫做wowace,ACE3库以及其他的函数库是目前大多数插件必备的内置库，ACE3库集成了魔兽世界插件中经常用到功能的和函数，极大方便了插件作者提高开发效率。wowace现在更新到了3版本，且各个版本之间不向下向下兼容，所以你最好选择一个稳定的版本做开发。

这里我们给出库的下载地址，[Ace3](http://www.wowace.com/addons/ace3/files/)以及API文档，[API](http://wow.gamepedia.com/WelcomeHome_-_Your_first_Ace3_Addon)。


## 与你的朋友合作

[https://www.wowace.com](https://www.wowace.com)上有wowace版本控制系统，注册一个帐号，你可以在svn或者git上与你的朋友一起写插件。

## 发布相关

[https://mods.curse.com](https://mods.curse.com)这个网站可以把你的插件发布到平台上，另外你也可以在这里下载别人的插件进行学习。


大致能想到的现在就是这么多，我也是刚刚开始做，如果遇到问题，我们可以交流。我还会将我做插件的过程记录下来，同大家一同学习。